<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <title>Document</title>
</head>
<style>
    body {
        background-color: antiquewhite;
        display: flex;
        justify-content: center;
    }
    
    .container {
        height: 400px;
        width: 700px;
        background-color: rgb(149, 213, 255);
        border: 1px solid black;
    }
    
    header {
        height: 50px;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        border-bottom: 1px solid black;
    }
    
    section {
        height: 300px;
        width: 500px;
        display: flex;
        justify-content: center;
    }
    
    .city {
        display: flex;
        justify-content: center;
        height: 80px;
        width: 100%;
        background-color: rgb(149, 213, 255);
    }
    
    #citySelect {
        display: flex;
        justify-content: center;
        background-color: rgb(149, 213, 255);
        width: 200px;
        margin-top: 20px;
        height: 50px;
        align-items: center;
        font-size: 100%;
    }
    
    .infomation {
        width: 100%;
    }
    
    section {
        width: 100%;
    }
    
    .listWeather {
        height: 200px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 25px;
        margin: auto;
    }
    
    .frame-day {
        width: 20%;
        margin-top: 10px;
    }
    
    .date {
        font-size: 30px;
        height: 20%;
    }
    
    .temp {
        display: flex;
        align-items: center;
        height: 20%;
    }
    
    #icon {
        height: 40%;
        font-size: 70px;
        color: black;
        width: 100%;
        display: flex;
        justify-content: center;
    }
    
    .desc {
        height: 20%;
        font-size: 20px;
    }
    
    .date,
    .temp,
    .icon,
    .desc {
        display: flex;
        justify-content: center;
        width: 100%;
    }
</style>

<body>
    <div class="container">
        <header>
            <h1>Weather Forecast</h1>
        </header>
        <section>
            <div class="infomation">
                <div class="city">
                    <select name="" id="citySelect">
                        <option id="nt" value="Nha Trang" selected><strong>Thành Phố Nha Trang</strong></option>   
                        <option id="hp" value="Ho Chi Minh">Thành Phố Hồ Chí Minh</option>     
                        <option id="hn" value="Ha Noi">Thành Phố Hà Nội</option>   
                    </select>

                    <!-- <p id="date" style="display: flex; align-items: center;"></p> -->
                </div>
                <div class="listWeather" id="listWeather">
                </div>
        </section>
        <footer>
            <p style="height: 30px; border-top: 1px solid black; display: flex; align-items: center; justify-content: center;">Đ/c: 8 Mạc Đĩnh Chi, Bến Nghé, Quận 1, Thành phố Hồ Chí Minh</p>
        </footer>
        </div>
</body>
<script>
    document.getElementById("citySelect").addEventListener("change", async function() {
        const city = this.value;

        try {
            const response = await fetch('/weatherForecast', { //https://weatherforecast-r0sh.onrender.com
                method: 'POST',
                headers: {
                    "Content-Type": 'application/json'
                },
                body: JSON.stringify({
                    city: city
                })
            });

            const data = await response.json();
            console.log("DATA:", data);
            const container = document.getElementById('listWeather');
            container.innerHTML = "";
            data.forEach(day => {
                container.innerHTML += `
                    <div class="frame-day" style="border-radius: 20px; border: 1px solid black;">

                        <div class="date">${day.day}</div>
                        <div class="temp">${day.temp}</div>
                        <i id="icon" class="${day.icon}"></i>
                        <div class="desc">${day.desc}</div>
                    </div>
                `
            })
        } catch (err) {
            console.error("Lỗi khi fetch API:", err);
        }
    });
    window.onload = function() {
        const citySelected = document.getElementById('citySelect');
        citySelected.value = "Nha Trang";
        citySelected.dispatchEvent(new Event("change"));
    }
</script>

</html>
